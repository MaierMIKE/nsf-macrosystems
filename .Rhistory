density() %>% lines()
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=.95) %>%
density() -> first.data
plot(first.data,ylim=c(0,.75),xlim=c(-1,7),col="red")
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=.95) %>%
density() -> first.data
plot(first.data,ylim=c(0,.75),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=.95) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=.95) %>%
density() %>% lines()
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=.95) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines()
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
# 13 studies, let's say 4 didn't have SD data
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# 13 studies, let's say 4 didn't have SD data
rnorm(1000,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# 13 studies, let's say 4 didn't have SD data
rnorm(100000,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# 13 studies, let's say 4 didn't have SD data
rnorm(1000,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
# For a distribution with 9 observations, what's the chance that the SD
# could be half, and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=0.51) %>%
density() %>% lines(lwd=1)
# Plot with 2x SD
rnorm(9,mean=2.7,sd=2.04) %>%
density() %>% lines(lwd=0.5)
# For a distribution with 9 observations, what's the chance that the SD
# could be half, and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot with half SD
rnorm(9,mean=2.7,sd=0.51) %>%
density() %>% lines(lwd=1)
# Plot with 2x SD
rnorm(9,mean=2.7,sd=2.04) %>%
density() %>% lines(lwd=1)
# Plot with 2x SD
rnorm(9,mean=2.7,sd=2.04) %>%
density() %>% lines(lwd=1)
# Plot with 2x SD
rnorm(9,mean=2.7,sd=2.04) %>%
density() %>% lines(lwd=1)
# For a distribution with 9 observations, what's the chance that the SD
# could be 50% greater and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot with 1.5x SD
rnorm(9,mean=2.7,sd=1.5) %>%
density() %>% lines(lwd=1)
# For a distribution with 9 observations, what's the chance that the SD
# could be 50% greater and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot with 1.5x SD
rnorm(9,mean=2.7,sd=1.5) %>%
density() %>% lines(lwd=1)
# Plot the true distribution
rnorm(1000,mean=2.7,sd=1.02) %>%
density() -> first.data
library(tidyverse)
# Plot the true distribution
rnorm(1000,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot the true distribution
rnorm(1000,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot the true distribution
rnorm(1000,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
rnorm(9,mean=2.7,sd=1.02) %>%
density() %>% lines(lwd=0.5)
# For a distribution with 9 observations, what's the chance that the SD
# could be 50% greater and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# For a distribution with 9 observations, what's the chance that the SD
# could be 50% greater and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot with 1.5x SD
rnorm(9,mean=2.7,sd=1.5) %>%
density() %>% lines(lwd=1)
# For a distribution with 9 observations, what's the chance that the SD
# could be 50% greater and still potentially come from the same distribution
rnorm(9,mean=2.7,sd=1.02) %>%
density() -> first.data
plot(first.data,ylim=c(0,1),xlim=c(-1,7),col="red",lwd=3)
# Plot with 1.5x SD
rnorm(9,mean=2.7,sd=1.5) %>%
density() %>% lines(lwd=1)
# Load packages
library(tidyverse)
library(rstan)
# Set working directory
setwd("~/Box Sync/Work/The Nature Conservancy/NSF Macrosystems/")
# Set global Stand conditions
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
#### Generate fake data ####
rand <- MASS::mvrnorm(n=10, mu=c(10, 20), Sigma=matrix(c(1, 0.8, 0.8, 1), nrow=2), empirical=TRUE)
# Generate y data which are n=10
y.data <- tibble::tibble(
y=rand[,1],
sample.id = c('sample1','sample2','sample3','sample4','sample5','sample6','sample7','sample8','sample9','sample10')
)
# Generate x data which are n=30 (10 samples x 3 repeats)
x.data <- tibble(
b=rnorm(30,2,0.2),
a_temp=rnorm(30,0,1),
row=seq(1:30),
sample.id=rep(c('sample1','sample2','sample3','sample4','sample5','sample6','sample7',
'sample8','sample9','sample10'),3)
) %>%
mutate(
a = ifelse(row %in% 1:10, rep(rand[,2]*b[1:10],3),
ifelse(row %in% 11:20, rep(rand[,2]*b[11:20],3),
ifelse(row %in% 21:30, rep(rand[,2]*b[21:30],3),'NA')))
) %>%
dplyr::select(a,b,sample.id)
x.data$a <- as.numeric(x.data$a)
x.data$b <- as.numeric(x.data$b)
rm(rand)
#### RUN NO ERROR MODEL ####
# Format data
data.typical <- aggregate(. ~ sample.id, data=x.data,FUN=mean) %>%
mutate(x = a/b) %>% left_join(y.data)
data.typical
#### RUN ERROR MODEL ####
e.dat <- list(
N = 10,
y = data.typical$y,
x_meas = data.typical$x,
tau = 0.1
)
e.dat
# Run model
p2 <- stan(file = "code/statistics/stan/sigma.stan", data = e.dat,
iter = 4000,
control=list(adapt_delta=0.95),
chains = 3)
# Run model
p2 <- stan(file = "code/statistics/stan/sigma.stan", data = e.dat,
iter = 4000,
control=list(adapt_delta=0.95),
chains = 3)
summary(p1)
# Run model
p1 <- stan(file = "code/statistics/stan/nosigma.stan", data = ne.dat,
iter = 4000,
control=list(adapt_delta=0.95),
chains = 3)
ne.dat <- list(
N = 10,
y = data.typical$y,
x = data.typical$x
)
# Run model
p1 <- stan(file = "code/statistics/stan/nosigma.stan", data = ne.dat,
iter = 4000,
control=list(adapt_delta=0.95),
chains = 3)
summary(p1)
print(p1)
print(p2)
#### RUN ERROR MODEL ####
aggregate(. ~ sample.id, data=x.data,FUN=sd) %>%
mutate(x = a/b) %>% left_join(y.data)
#### RUN ERROR MODEL ####
aggregate(. ~ sample.id, data=x.data,FUN=mean) %>%
mutate(x = a/b) %>% left_join(y.data)
#### RUN ERROR MODEL ####
aggregate(. ~ sample.id, data=x.data,FUN=std) %>%
mutate(x = a/b) %>% left_join(y.data)
#### RUN ERROR MODEL ####
aggregate(. ~ sample.id, data=x.data,FUN=sd) %>%
mutate(x = a/b) %>% left_join(y.data)
x.data
data.typical
print(p1)
print(p2)
data.typical$x
